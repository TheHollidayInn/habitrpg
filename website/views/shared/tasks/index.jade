// Note here, we need this part of Habit to be a directive since we're going to be passing it variables from various
// parts of the app. The alternative would be to create new scopes for different containing sections, but that
// started to get unwieldy

include ./task_view/mixins
include ./task-list
include ./task

script(id='templates/habitrpg-tasks.html', type="text/ng-template")
  .tasks-lists.container-fluid()
    .row(
        ng-repeat='list in lists', 
        ng-class='::{ "rewards-module": list.type==="reward", "new-row-md": list.type==="todo", "col-md-3": "enabledLists.length === 4", "col-sm-6": "enabledLists.length === 4" }',
        ng-if="enabledLists.indexOf(list.type + 's') !== -1",
        class="col-md-3"
      )
        .task-column(class='{{::list.type}}s')
          include ./task_view/graph

          h2.task-column_title(ng-hide="customTaskTitles[list.type + 's']", class='{{::list.type}}-title') {{::list.header}}
          h2.task-column_title(ng-show="customTaskTitles[list.type + 's']", ng-init="customTitle = customTaskTitles[list.type + 's']" class='{{::list.type}}-title') {{env.t(customTitle)}}

          include ./task_view/help

          .todos-chart(ng-if='::list.type == "todo"', ng-show='charts.todos')
          
          if (env.FEATURES_CONFIG.GAME.TASK_OPTIONS.ADD !== 'false')
            include ./task_view/add_new

          alert.alert-warning.dailiesRestingInInn(ng-if='list.type == "daily" && user.preferences.sleep && !$state.includes("options.social.challenges")')
            i.glyphicon.glyphicon-warning-sign &nbsp;
            =env.t('dailiesRestingInInn')

            button.btn-block.btn.btn-lg.btn-success(ng-click='User.sleep({})')
              | {{env.t('innCheckOut')}}

          if (env.FEATURES_CONFIG.GAME.TASK_OPTIONS.FILTER !== 'false')
            +taskColumnTabs('top')

          // Actual List
          task-list

          include ./task_view/static_rewards

          include ./task_view/skills
          
          if (env.FEATURES_CONFIG.GAME.TASK_OPTIONS.FILTER !== 'false')
            +taskColumnTabs('bottom')
    
    .row.col-md-4
      .task-column
        h2.task-column_title=env.t('teamLeaderboard')
        leaderboard
